# é‡‘å±åŠ å·¥ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ è©³ç´°ä»•æ§˜æ›¸

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ã‚·ã‚¹ãƒ†ãƒ å
**é‡‘å±åŠ å·¥ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼** (Metal Processing Troubleshooter)

### 1.2 ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦
é‡‘å±åŠ å·¥ç¾å ´ã§ç™ºç”Ÿã™ã‚‹å•é¡Œã‚’æ®µéšçš„ã«è¨ºæ–­ã—ã€æœ€é©ãªè§£æ±ºç­–ã‚’ææ¡ˆã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚AIæŠ€è¡“ã‚’æ´»ç”¨ã—ã¦è©³ç´°ãªåˆ†æã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã™ã‚‹ã€‚

### 1.3 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js + React + TypeScript
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Next.js API Routes
- **AI**: Google Generative AI (Gemini 1.5 Flash)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: TSParticles

## 2. ç”»é¢ä»•æ§˜

### 2.1 ãƒ¡ã‚¤ãƒ³ç”»é¢ (src/app/page.tsx)

#### 2.1.1 ç”»é¢æ§‹æˆ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/page.tsx`
**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: `TroubleshootingContent`

**ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LanguageSelector (å³ä¸Š)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã‚¿ã‚¤ãƒˆãƒ« (ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ)     â”‚
â”‚ èª¬æ˜æ–‡ (Step 0ã®ã¿)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æˆ»ã‚‹ãƒœã‚¿ãƒ³ (Step 1ä»¥é™)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¸æŠè‚¢ã‚«ãƒ¼ãƒ‰ (ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ)     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ã‚«ãƒ¼ãƒ‰1  â”‚ â”‚ ã‚«ãƒ¼ãƒ‰2  â”‚ â”‚ ã‚«ãƒ¼ãƒ‰3  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.2 çŠ¶æ…‹ç®¡ç†
```typescript
interface TroubleshootingState {
  data: AdviceData | null
  currentStep: number
  selectionPath: string[]
  currentAdvice: Advice | null
  diagnosisContext: DiagnosisContext | null
}
```

#### 2.1.3 ã‚¹ãƒ†ãƒƒãƒ—ç®¡ç†
- **Step 0**: ã‚«ãƒ†ã‚´ãƒªé¸æŠ
- **Step 1**: å•é¡Œé¸æŠ
- **Step 2+**: è©³ç´°é¸æŠ
- **Result**: çµæœè¡¨ç¤º

### 2.2 çµæœè¡¨ç¤ºç”»é¢ (src/components/TroubleshootingResults.tsx)

#### 2.2.1 ç”»é¢æ§‹æˆ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¢ã‚¤ã‚³ãƒ³ + ã‚¿ã‚¤ãƒˆãƒ«                  â”‚
â”‚ è¨ºæ–­ç²¾åº¦ãƒ»é¸æŠãƒ‘ã‚¹è¡¨ç¤º               â”‚
â”‚ èª¬æ˜æ–‡                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‚è€ƒç”»åƒã‚»ã‚¯ã‚·ãƒ§ãƒ³ (è©²å½“æ™‚)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‚è€ƒå‹•ç”»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ (è©²å½“æ™‚)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºæœ¬å¯¾ç­–ãƒªã‚¹ãƒˆ                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å¯¾ç­–1: ã‚¿ã‚¤ãƒˆãƒ«                 â”‚ â”‚
â”‚ â”‚ èª¬æ˜æ–‡                          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIè©³ç´°åˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†è¨ºæ–­ãƒœã‚¿ãƒ³                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.2 è¡¨ç¤ºè¦ç´ 
- **è¨ºæ–­ç²¾åº¦**: 95%å›ºå®š
- **é¸æŠãƒ‘ã‚¹**: ã‚«ãƒ†ã‚´ãƒª â†’ å•é¡Œ â†’ è©³ç´°
- **åŸºæœ¬å¯¾ç­–**: æœ€å¤§3é …ç›®
- **å‚è€ƒãƒ¡ãƒ‡ã‚£ã‚¢**: ç”»åƒãƒ»å‹•ç”»ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

## 3. ãƒ‡ãƒ¼ã‚¿ä»•æ§˜

### 3.1 ã‚¢ãƒ‰ãƒã‚¤ã‚¹ãƒ‡ãƒ¼ã‚¿æ§‹é€  (src/lib/dataLoader.ts)

#### 3.1.1 ãƒ¡ã‚¤ãƒ³ã‚«ãƒ†ã‚´ãƒª
```typescript
interface MainCategory {
  id: string        // 'surface', 'tool', 'dimension', 'material'
  label: string     // è¡¨ç¤ºå
  icon: string      // çµµæ–‡å­—ã‚¢ã‚¤ã‚³ãƒ³
  description: string // èª¬æ˜æ–‡
  priority: number  // å„ªå…ˆåº¦
}
```

**å®Ÿè£…ãƒ‡ãƒ¼ã‚¿**:
```typescript
const mainCategories = [
  { id: 'surface', label: 'è¡¨é¢ä»•ä¸Šã’', icon: 'ğŸ˜µ', description: 'ä»•ä¸Šã’é¢ã®ç²—ã•ã‚„å“è³ªã«é–¢ã™ã‚‹å•é¡Œ', priority: 1 },
  { id: 'tool', label: 'å·¥å…·é–¢é€£', icon: 'ğŸ”¨', description: 'åˆ‡å‰Šå·¥å…·ã®æ‘©è€—ã‚„ç ´æã«é–¢ã™ã‚‹å•é¡Œ', priority: 2 },
  { id: 'dimension', label: 'å¯¸æ³•ç²¾åº¦', icon: 'ğŸ“', description: 'å¯¸æ³•ã®ã°ã‚‰ã¤ãã‚„ç²¾åº¦ã«é–¢ã™ã‚‹å•é¡Œ', priority: 3 },
  { id: 'material', label: 'ææ–™å•é¡Œ', icon: 'ğŸ”Š', description: 'ææ–™ã®æ€§è³ªã‚„åŠ å·¥æ€§ã«é–¢ã™ã‚‹å•é¡Œ', priority: 4 }
]
```

#### 3.1.2 å•é¡Œãƒãƒ¼ãƒ‰
```typescript
interface AdviceNode {
  id: string
  label: string
  icon: string
  description?: string
  category?: string
  children?: AdviceNode[]
  advice?: Advice
}
```

#### 3.1.3 ã‚¢ãƒ‰ãƒã‚¤ã‚¹
```typescript
interface Advice {
  title: string
  text: string
  icon: string
  items?: { title: string; description: string }[]
  image?: string
  video?: string
}
```

### 3.2 ç¿»è¨³ãƒ‡ãƒ¼ã‚¿æ§‹é€  (src/lib/translations.ts)

#### 3.2.1 è¨€èªè¨­å®š
```typescript
type Language = 'ja' | 'en' | 'vi'
```

#### 3.2.2 ç¿»è¨³ã‚­ãƒ¼æ§‹é€ 
```typescript
const translations = {
  ja: {
    // UIè¦ç´ 
    whatProblem: 'ã©ã®ã‚ˆã†ãªå•é¡Œã§ãŠå›°ã‚Šã§ã™ã‹ï¼Ÿ',
    selectProblem: 'å•é¡Œã‚’é¸æŠã—ã¦ã€æœ€é©ãªè§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†',
    back: 'æˆ»ã‚‹',
    
    // ã‚«ãƒ†ã‚´ãƒª
    'categories.surface': 'è¡¨é¢ä»•ä¸Šã’',
    'categories.tool': 'å·¥å…·é–¢é€£',
    // ...
    
    // å•é¡Œ
    'problems.surface-dirty': 'åŠ å·¥é¢ãŒæ±šã„',
    'problems.surface-rough': 'ã‚¶ãƒ©ã‚¶ãƒ©ã—ã¦ã„ã‚‹',
    // ...
    
    // ã‚¢ãƒ‰ãƒã‚¤ã‚¹
    'adviceTitle.surface-rough': 'é€ã‚Šãƒãƒ¼ã‚¯æ”¹å–„ç­–',
    'adviceText.surface-rough': 'é€ã‚Šé€Ÿåº¦ã®èª¿æ•´ã¨å·¥å…·é¸å®šã«ã‚ˆã‚Šé€ã‚Šãƒãƒ¼ã‚¯ã‚’æ”¹å–„ã§ãã¾ã™ã€‚',
    // ...
  },
  en: { /* è‹±èªç¿»è¨³ */ },
  vi: { /* ãƒ™ãƒˆãƒŠãƒ èªç¿»è¨³ */ }
}
```

## 4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä»•æ§˜

### 4.1 TroubleshootingContent

#### 4.1.1 ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
```typescript
// ç¾åœ¨ã®é¸æŠè‚¢ã‚’å–å¾—
const getCurrentOptions = (): (CategoryOption | AdviceNode)[] => {
  if (!data) return []
  
  if (currentStep === 0) {
    return [...data.mainCategories, data.otherCategory]
  }
  
  if (currentStep === 1) {
    const selectedCategory = selectionPath[0]
    return data.problems.filter(p => p.category === selectedCategory)
  }
  
  const currentNode = getCurrentNode()
  return currentNode?.children || []
}

// é¸æŠå‡¦ç†
const handleOptionSelect = (option: CategoryOption | AdviceNode) => {
  if (!data) return

  const newPath = [...selectionPath, option.id]
  setSelectionPath(newPath)

  if (currentStep === 0) {
    setCurrentStep(1)
  } else if (currentStep === 1) {
    const selectedProblem = data.problems.find(p => p.id === option.id)
    if (selectedProblem?.children && selectedProblem.children.length > 0) {
      setCurrentStep(2)
    } else if (selectedProblem?.advice) {
      const context = buildDiagnosisContext(newPath)
      setDiagnosisContext(context)
      setCurrentAdvice(selectedProblem.advice)
    }
  } else {
    // è©³ç´°é¸æŠå‡¦ç†
  }
}
```

### 4.2 TroubleshootingResults

#### 4.2.1 è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
```typescript
// ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºã•ã‚ŒãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’å–å¾—
const getLocalizedAdvice = (): Advice => {
  const problemId = context.selectionPath[context.selectionPath.length - 1]
  
  return {
    ...advice,
    title: t(`adviceTitle.${problemId}`) || advice.title,
    text: t(`adviceText.${problemId}`) || advice.text,
    items: advice.items?.map(item => ({
      ...item,
      title: t(`problems.${problemId}`) || item.title,
      description: t(`problemDescriptions.${problemId}`) || item.description
    }))
  }
}
```

#### 4.2.2 ç”»åƒãƒ»å‹•ç”»è¡¨ç¤º
```typescript
// ç”»åƒè¡¨ç¤ºï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ãï¼‰
{localizedAdvice.image && (
  <img 
    src={`/media/${localizedAdvice.image}`}
    alt={localizedAdvice.title}
    onError={(e) => {
      // ã‚¨ãƒ©ãƒ¼æ™‚ã®ä»£æ›¿è¡¨ç¤º
      const target = e.target as HTMLImageElement
      target.style.display = 'none'
      // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    }}
  />
)}
```

### 4.3 AIDetailedAdvice

#### 4.3.1 AIåˆ†æå®Ÿè¡Œ
```typescript
const generateAIAdvice = async () => {
  setIsLoading(true)
  setError('')
  
  try {
    // ç¾åœ¨ã¯ä»®ã®å¿œç­”
    await new Promise(resolve => setTimeout(resolve, 2000))
    setAiAdvice('AIåˆ†æçµæœï¼šåˆ‡å‰Šæ¡ä»¶ã‚’æœ€é©åŒ–ã™ã‚‹ã“ã¨ã§ã€ã“ã®å•é¡Œã‚’åŠ¹æœçš„ã«è§£æ±ºã§ãã¾ã™ã€‚')
  } catch (err) {
    setError(t('aiError'))
  } finally {
    setIsLoading(false)
  }
}
```

## 5. APIä»•æ§˜

### 5.1 AIåˆ†æAPI (src/app/api/ai-advice/route.ts)

#### 5.1.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **URL**: `/api/ai-advice`
- **ãƒ¡ã‚½ãƒƒãƒ‰**: POST
- **Content-Type**: application/json

#### 5.1.2 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```typescript
{
  prompt: string  // AIã¸ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
}
```

#### 5.1.3 ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```typescript
{
  advice: string      // AIã®å›ç­”
  timestamp: string   // ISOå½¢å¼ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
  length: number      // å›ç­”ã®æ–‡å­—æ•°
}
```

#### 5.1.4 ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```typescript
{
  error: string       // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  details: string     // è©³ç´°æƒ…å ±
}
```

#### 5.1.5 AIè¨­å®š
```typescript
const model = genAI.getGenerativeModel({ 
  model: 'gemini-1.5-flash',
  generationConfig: {
    temperature: 0.7,
    topK: 40,
    topP: 0.95,
    maxOutputTokens: 800,
  }
})
```

## 6. ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ä»•æ§˜

### 6.1 ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

#### 6.1.1 ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
```css
/* èƒŒæ™¯ */
background: linear-gradient(to bottom, #111827, #000000)

/* ã‚«ãƒ¼ãƒ‰èƒŒæ™¯ */
background: rgba(30, 30, 50, 0.8)

/* ãƒœã‚¿ãƒ³ */
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)

/* ãƒ†ã‚­ã‚¹ãƒˆ */
color: #ffffff
color: #a0a0a0  /* ã‚»ã‚«ãƒ³ãƒ€ãƒª */
color: #667eea  /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ */
```

#### 6.1.2 ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£
```css
/* ãƒ•ã‚©ãƒ³ãƒˆ */
font-family: 'Inter', sans-serif

/* ã‚µã‚¤ã‚º */
h1: 32px
h3: 20px
p: 16px
small: 14px
```

#### 6.1.3 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
```css
/* ã‚°ãƒªãƒƒãƒ‰ */
display: grid
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr))
gap: 20px

/* ã‚«ãƒ¼ãƒ‰ */
border-radius: 15px
padding: 25px
border: 2px solid rgba(255, 255, 255, 0.1)
```

### 6.2 ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

#### 6.2.1 ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
```typescript
onMouseEnter={(e) => {
  e.currentTarget.style.borderColor = 'rgba(102, 126, 234, 0.5)'
  e.currentTarget.style.transform = 'translateY(-2px)'
  e.currentTarget.style.boxShadow = '0 8px 25px rgba(102, 126, 234, 0.15)'
}}
```

#### 6.2.2 èƒŒæ™¯ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: TSParticles
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: ParticleBackground
- **åŠ¹æœ**: æµ®éŠã™ã‚‹ç²’å­ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

## 7. çŠ¶æ…‹ç®¡ç†

### 7.1 ç¿»è¨³çŠ¶æ…‹ (src/hooks/useTranslation.tsx)

#### 7.1.1 Context
```typescript
interface TranslationContextType {
  language: Language
  setLanguage: (lang: Language) => void
  t: (key: string) => string
}
```

#### 7.1.2 Provider
```typescript
export function TranslationProvider({ children }: { children: ReactNode }) {
  const [language, setLanguage] = useState<Language>('ja')
  
  const t = (key: string): string => {
    const value = (translations[language] as any)[key]
    return value || key
  }
  
  return (
    <TranslationContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </TranslationContext.Provider>
  )
}
```

### 7.2 è¨ºæ–­çŠ¶æ…‹
```typescript
// ãƒ¡ã‚¤ãƒ³çŠ¶æ…‹
const [data, setData] = useState<AdviceData | null>(null)
const [currentStep, setCurrentStep] = useState(0)
const [selectionPath, setSelectionPath] = useState<string[]>([])
const [currentAdvice, setCurrentAdvice] = useState<Advice | null>(null)
const [diagnosisContext, setDiagnosisContext] = useState<DiagnosisContext | null>(null)

// AIåˆ†æçŠ¶æ…‹
const [isLoading, setIsLoading] = useState(false)
const [aiAdvice, setAiAdvice] = useState<string>('')
const [error, setError] = useState<string>('')
```

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 8.1 ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
```typescript
if (!data) {
  return (
    <div style={{ 
      display: 'flex', 
      justifyContent: 'center', 
      alignItems: 'center', 
      height: '200px',
      fontSize: '18px'
    }}>
      èª­ã¿è¾¼ã¿ä¸­...
    </div>
  )
}
```

### 8.2 ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
```typescript
onError={(e) => {
  console.log('ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', localizedAdvice.image)
  const target = e.target as HTMLImageElement
  target.style.display = 'none'
  const parent = target.parentElement
  if (parent) {
    parent.innerHTML = `
      <div style="padding: 40px; background: rgba(255,255,255,0.05); border: 2px dashed rgba(255,255,255,0.2); color: #888; border-radius: 10px;">
        ğŸ“· æ¢ã—ã¦ã„ã‚‹ç”»åƒ: ${localizedAdvice.image}<br>
        ğŸ” å®Ÿéš›ã®ãƒ‘ã‚¹: /media/${localizedAdvice.image}<br>
        ğŸ“ åˆ©ç”¨å¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«: surface_bad.jpg, tool_broken.jpg<br>
        <small style="color: #666;">ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</small>
      </div>
    `
  }
}}
```

### 8.3 AI APIã‚¨ãƒ©ãƒ¼
```typescript
catch (error) {
  console.error('âŒ Gemini AI error:', error)
  return NextResponse.json(
    { 
      error: 'AI ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ',
      details: error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'
    },
    { status: 500 }
  )
}
```

## 9. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 9.1 å®Ÿè£…æ¸ˆã¿æœ€é©åŒ–
- **Next.js App Router**: æœ€æ–°ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 
- **Turbopack**: é«˜é€Ÿé–‹ç™ºã‚µãƒ¼ãƒãƒ¼
- **ã‚³ãƒ¼ãƒ‰åˆ†å‰²**: å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- **ç”»åƒæœ€é©åŒ–**: Next.js Image component

### 9.2 ãƒ‡ãƒ¼ã‚¿æœ€é©åŒ–
- **é™çš„ãƒ‡ãƒ¼ã‚¿**: JSONãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ç®¡ç†
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨
- **é…å»¶èª­ã¿è¾¼ã¿**: å¿…è¦æ™‚ã®ã¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿

## 10. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### 10.1 å®Ÿè£…æ¸ˆã¿å¯¾ç­–
- **ç’°å¢ƒå¤‰æ•°**: APIã‚­ãƒ¼ã®é©åˆ‡ãªç®¡ç†
- **å‹ãƒã‚§ãƒƒã‚¯**: TypeScriptã«ã‚ˆã‚‹å…¥åŠ›æ¤œè¨¼
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼è¡¨ç¤º

### 10.2 æ¨å¥¨å¯¾ç­–
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: APIå‘¼ã³å‡ºã—ã®åˆ¶é™
- **CORSè¨­å®š**: é©åˆ‡ãªã‚ªãƒªã‚¸ãƒ³åˆ¶é™
- **å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**: XSSå¯¾ç­–

## 11. ãƒ†ã‚¹ãƒˆä»•æ§˜

### 11.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
```typescript
// ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ
describe('loadAdviceData', () => {
  it('should load main categories', async () => {
    const data = await loadAdviceData()
    expect(data.mainCategories).toHaveLength(4)
  })
})

// ç¿»è¨³ãƒ†ã‚¹ãƒˆ
describe('useTranslation', () => {
  it('should return correct translation', () => {
    const { t } = useTranslation()
    expect(t('whatProblem')).toBe('ã©ã®ã‚ˆã†ãªå•é¡Œã§ãŠå›°ã‚Šã§ã™ã‹ï¼Ÿ')
  })
})
```

### 11.2 çµ±åˆãƒ†ã‚¹ãƒˆ
```typescript
// APIãƒ†ã‚¹ãƒˆ
describe('/api/ai-advice', () => {
  it('should return AI advice', async () => {
    const response = await fetch('/api/ai-advice', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt: 'test' })
    })
    expect(response.status).toBe(200)
  })
})
```

## 12. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### 12.1 ç’°å¢ƒå¤‰æ•°
```env
GOOGLE_AI_API_KEY=your_gemini_api_key
```

### 12.2 ãƒ“ãƒ«ãƒ‰è¨­å®š
```json
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

### 12.3 ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
2. `npm run build` ã®å®Ÿè¡Œ
3. é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®é…ä¿¡
4. ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š

## 13. ä¿å®ˆãƒ»é‹ç”¨

### 13.1 ãƒ­ã‚°ç®¡ç†
```typescript
// AIå‘¼ã³å‡ºã—ãƒ­ã‚°
console.log('ğŸ”¥ AIå‘¼ã³å‡ºã—é–‹å§‹:', prompt.substring(0, 100) + '...')
console.log('âœ… AIå›ç­”ç”Ÿæˆå®Œäº†:', advice.length, 'æ–‡å­—')

// ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
console.error('âŒ Gemini AI error:', error)
```

### 13.2 ç›£è¦–é …ç›®
- APIå¿œç­”æ™‚é–“
- ã‚¨ãƒ©ãƒ¼ç‡
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹æ•°
- AIä½¿ç”¨é‡

### 13.3 æ›´æ–°æ‰‹é †
1. ãƒ‡ãƒ¼ã‚¿æ›´æ–°: `src/lib/dataLoader.ts`
2. ç¿»è¨³æ›´æ–°: `src/lib/translations.ts`
3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ›´æ–°: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
4. ãƒ‡ãƒ—ãƒ­ã‚¤: Vercelç­‰ã§ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

---

**ä½œæˆæ—¥**: 2024å¹´12æœˆ
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆè€…**: AI Assistant
**æ‰¿èªè€…**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ 